# Source Info:
#  {
#    "Provider": "KS_COMMERCE",
#    "State": "KS",
#    "Name": "Kansas Department of Commerce",
#    "Title": "Minority and Women Business Directory Search",
#    "ImportedFileName": "BusinessExport.csv"
#  }

# Field Mapping:
#
# ╔═══════════════════════════╦═══════════════════════════╦════════════╗
# ║ DEST_COL_NAME             ║ SRC_COL_NAME              ║ SRC_COL_NO ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Sequence                  ║ Program                   ║  Generated ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Company Name              ║ Business Name             ║      1     ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ DBA                       ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ DUNS Number               ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Addr Line 1               ║ Street Address            ║      2     ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Addr Line 2               ║ PO Box                    ║      3     ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ City                      ║ City                      ║      4     ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ State                     ║ StateCode                 ║      5     ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Zip Code                  ║ 5-digit Zip Code          ║      6     ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Website                   ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Contact Person            ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Phone                     ║ Phone                     ║      8     ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Cell Phone                ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Fax                       ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Email Address             ║ Email                     ║      7     ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Gender                    ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Ethnicity                 ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Given Diversity           ║ MBE                       ║      9     ║
# ║                           ║ WBE                       ║     10     ║
# ║                           ║ DBE                       ║     11     ║
# ║                           ║ ACDBE                     ║     12     ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Primary Diversity         ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Other Diversities         ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Certifying Agency         ║ "Kansas Dept of Commerce" ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Certification Number      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Certification Start Date  ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Certification Expiry Date ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Primary NAICS Code        ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Other NAICS Codes         ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Business Description      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Additional Details 1      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Additional Details 2      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Additional Details 3      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Additional Details 4      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Additional Details 5      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Additional Details 6      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Additional Details 7      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Additional Details 8      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Additional Details 9      ║                           ║            ║
# ╠═══════════════════════════╬═══════════════════════════╬════════════╣
# ║ Additional Details 10     ║                           ║            ║
# ╚═══════════════════════════╩═══════════════════════════╩════════════╝

import csv
import logging

from src import custom_logger, prepare_csv_data, empty_dict

log = custom_logger.LogGen.logGen()
log.setLevel(level=logging.DEBUG)

provider = "KS_COMMERCE"
records = []


def processFile(filename):
    log.info(f'Loaded module {provider}...')

    with open(filename, encoding="utf8") as f:
        reader = csv.reader(f)
        next(reader, None)

        for row_num, row in enumerate(reader):
            dict1 = empty_dict()
            diversity = []
            dict1['source'] = provider
            dict1['sequence'] = prepare_csv_data(row_num + 1)
            dict1['company'] = prepare_csv_data(row[0])
            dict1['addr1'] = prepare_csv_data(row[1])
            dict1['addr2'] = prepare_csv_data(row[2])
            dict1['city'] = prepare_csv_data(row[3])
            dict1['state'] = prepare_csv_data(row[4])
            dict1['zipcode'] = prepare_csv_data(row[5])
            dict1['phone'] = prepare_csv_data(row[7])
            dict1['email'] = prepare_csv_data(row[6])
            if row[8] == 'Certified': diversity.append('MBE')
            if row[9] == 'Certified': diversity.append('WBE')
            if row[10] == 'Certified': diversity.append('DBE')
            if row[11] == 'Certified': diversity.append('ACDBE')
            dict1['gdiverse'] = ','.join(diversity)
            dict1['cert_agency'] = 'Kansas Dept. of Commerce'
            records.append(dict1)

        return records
