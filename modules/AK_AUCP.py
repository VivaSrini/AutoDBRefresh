# Source Info:
#  {
#    "Provider": "AK_AUCP",
#    "State": "AK",
#    "Name": "Alaska Unified Certification Program - AUCP",
#    "Title": Disadvantaged Business Enterprise (DBE) Directory, Civil Rights
#             Office, Transportation & Public Facilities, State of Alaska",
#    "ImportedFileName": "Disadvantaged Business Enterprise (DBE) Directory, Civil Rights
#                         Office, Transportation  Public Facilities, State of Alaska.csv"
#  }

# Field Mapping:
#
# ╔════════════════════════════╦══════════════════════╦════════════╗
# ║ DEST_COL_NAME              ║ SRC_COL_NAME         ║ SRC_COL_NO ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Sequence                   ║ Program              ║ Generated  ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Company Name               ║ Vendor Name          ║ 2          ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ DBA                        ║                      ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ DUNS Number                ║                      ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Addr Line 1                ║ Address              ║ 13         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Addr Line 2                ║                      ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ City                       ║ City                 ║ 15         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ State                      ║ State                ║ 16         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Zip Code                   ║ ZipCode              ║ 17         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Website                    ║ Website              ║ 8          ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Contact Person             ║ DBE Contact          ║ 24         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Phone                      ║ Phone                ║ 22         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Cell Phone                 ║                      ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Fax                        ║ Fax                  ║ 23         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Email Address              ║ Email                ║ 14         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Gender                     ║                      ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Ethnicity                  ║                      ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Given Diversity            ║ Type                 ║ 4          ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Primary Diversity          ║                      ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Other Diversities          ║                      ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Certifying Agency          ║ "AUCP"               ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Certification Number       ║ DBE Cert Number      ║ 10         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Certification Start Date   ║                      ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Certification Expiry Date  ║                      ║            ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Primary NAICS Code         ║ NAICS                ║ 18         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Other NAICS Codes          ║ NAICS                ║ 18         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Business Description       ║ Business Description ║ 11         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Additional Details 1       ║ ACDBE                ║ 3          ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Additional Details 2       ║ GFE Required         ║ 5          ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Additional Details 3       ║ Work Category        ║ 6          ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Additional Details 4       ║ Regions              ║ 7          ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Additional Details 5       ║ Work Category Codes  ║ 19         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Additional Details 6       ║ Boroughs             ║ 20         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Additional Details 7       ║ License              ║ 21         ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Additional Details 8       ║ Max Capacity         ║ 9          ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Additional Details 9       ║ Vendor Id            ║ 1          ║
# ╠════════════════════════════╬══════════════════════╬════════════╣
# ║ Additional Details 10      ║                      ║            ║
# ╚════════════════════════════╩══════════════════════╩════════════╝
#

import csv
import logging

from src import custom_logger, prepare_csv_data, empty_dict, get_primary, get_other

log = custom_logger.LogGen.logGen()
log.setLevel(level=logging.DEBUG)

provider = "AK_AUCP"
records = []


def processFile(filename):
    log.info(f'Loaded module {provider}...')

    with open(filename, encoding="utf8") as f:
        reader = csv.reader(f)
        next(reader, None)

        for row_num, row in enumerate(reader):
            dict1 = empty_dict()
            dict1['source'] = provider
            dict1['sequence'] = prepare_csv_data(row_num + 1)
            dict1['company'] = prepare_csv_data(row[1])
            dict1['addr1'] = prepare_csv_data(row[12])
            dict1['city'] = prepare_csv_data(row[14])
            dict1['state'] = prepare_csv_data(row[15])
            dict1['zipcode'] = prepare_csv_data(row[16])
            dict1['website'] = prepare_csv_data(row[7])
            dict1['contact'] = prepare_csv_data(row[23])
            dict1['phone'] = prepare_csv_data(row[21])
            dict1['fax'] = prepare_csv_data(row[22])
            dict1['email'] = prepare_csv_data(row[13])
            dict1['gdiverse'] = prepare_csv_data(row[3])
            dict1['cert_agency'] = 'AL UCP'
            dict1['cert_num'] = prepare_csv_data(row[9])
            dict1['pnaics'] = prepare_csv_data(get_primary(row[17], pattern=r'[0-9]{6}'))
            dict1['onaics'] = prepare_csv_data(get_other(row[17], pattern=r'[0-9]{6}'))
            dict1['biz_desc'] = prepare_csv_data(row[10])
            dict1['addl1'] = prepare_csv_data(row[2], prefix='ACDBE?')
            dict1['addl2'] = prepare_csv_data(row[4], prefix='GFE Required?')
            dict1['addl3'] = prepare_csv_data(row[5], prefix='Work Category')
            dict1['addl4'] = prepare_csv_data(row[6], prefix='Regions')
            dict1['addl5'] = prepare_csv_data(row[18], prefix='Work Category Codes')
            dict1['addl6'] = prepare_csv_data(row[19], prefix='Borough(s)')
            dict1['addl7'] = prepare_csv_data(row[20], prefix='License')
            dict1['addl8'] = prepare_csv_data(row[8], prefix='Max Capacity')
            dict1['addl9'] = prepare_csv_data(row[0], prefix='Vendor Id')
            records.append(dict1)

        return records
